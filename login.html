<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Sign in • Secure File Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --bg:#0b1020; --card:#121a35; --fg:#e7ecff; --muted:#a9b3d4; --accent:#5aa9ff; --danger:#e25a5a; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background:linear-gradient(180deg,#0b1020,#0a0f1e 40%); color:var(--fg); }
    .wrap{ max-width:420px; margin:8vh auto; background:var(--card); padding:28px; border-radius:16px; box-shadow:0 10px 40px rgba(0,0,0,.4); }
    h1{ margin:0 0 8px; font-size:22px; }
    p{ margin:0 0 18px; color:var(--muted); }
    label{ display:block; font-size:14px; margin:14px 0 6px; color:var(--muted); }
    input{ width:100%; padding:12px 14px; border-radius:10px; border:1px solid #223; background:#0e1530; color:var(--fg); }
    button{ margin-top:16px; width:100%; padding:12px 14px; border-radius:10px; border:0; background:var(--accent); color:#001022; font-weight:600; cursor:pointer; }
    .link{ margin-top:14px; text-align:center; color:var(--muted); font-size:14px; }
    .msg{ margin-top:12px; padding:10px; border-radius:8px; display:none; }
    .err{ background:#3b0f0f; color:#ffc7c7; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Sign in</h1>
    <p>Enter your email and password.</p>

    <label for="email">Email</label>
    <input id="email" type="email" placeholder="you@example.com" />

    <label for="pwd">Password</label>
    <input id="pwd" type="password" placeholder="••••••••" />

    <button id="btn">Sign in</button>
    <div id="err" class="msg err"></div>

    <div class="link">No account?  <a href="register.html">Create one</a></div>
  </div>

<script>
  const FN_BASE = "https://<YOUR-FUNCTION-APP>.azurewebsites.net";
  const LOGIN_URL = `${FN_BASE}/api/loginUser`;

  const err = document.getElementById('err');

  document.getElementById('btn').onclick = async () => {
    err.style.display = 'none';
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('pwd').value;

    if (!email || !password) {
      err.textContent = 'Please enter email and password';
      err.style.display = 'block';
      return;
    }

    try {
      const res = await fetch(LOGIN_URL, {
        method: 'POST',
        headers: { 'Content-Type':'application/json' },
        body: JSON.stringify({ email, password })
      });
      const data = await res.json().catch(() => ({}));
      if (!res.ok) throw new Error(data.error || `HTTP ${res.status}`);

      // store simple session (userId)
      localStorage.setItem('userId', data.userId || email);
      // go to dashboard
      location.href = 'dashboard.html';
    } catch (e) {
      err.textContent = e.message;
      err.style.display = 'block';
    }
  };
</script>
</body>
</html>
